// Generated by CoffeeScript 1.4.0
(function() {
  var animation_delay, animation_speed, changePage, loadPageContent;

  animation_speed = 700;

  animation_delay = 300;

  $(function() {
    $(".container").hide().delay(animation_delay).fadeIn(animation_speed);
    return $(document).on("click", ".primary-navigation li a, .logo a", function(e) {
      e.preventDefault();
      return changePage($(this).attr("href").replace(/^\/|\/$/g, ""));
    });
  });

  changePage = function(newURL) {
    var page_slug;
    if ($("body").attr("class") === newURL) {
      return;
    }
    page_slug = (newURL === "" ? "index" : newURL);
    loadPageContent(newURL, true);
    if (typeof _gaq !== "undefined") {
      return _gaq.push(["_trackPageview", newURL + "/"]);
    }
  };

  loadPageContent = function(newURL, pageChange) {
    return $.get("/pages/" + page_slug, function(data) {
      if (pageChange) {
        History.pushState(page_slug, document.title.replace(/^(.*)\|.*$/, "$1 | ") + data.title, "/" + newURL);
      }
      $("body").attr("class", newURL);
      return $("#content-wrapper").showHtml(ich.content(data, animation_speed));
    });
  };

}).call(this);
