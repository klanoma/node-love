// Generated by CoffeeScript 1.4.0
(function() {
  var animation_delay, animation_speed, changePage;

  animation_speed = 1000;

  animation_delay = 200;

  $(function() {
    var History;
    $(".container").hide().delay(animation_delay).fadeIn(animation_speed);
    $(document).on("click", ".primary-navigation li a, .logo a", function(e) {
      var change_url;
      e.preventDefault();
      change_url = $(this).data("url");
      if (change_url === "index") {
        change_url = "";
      }
      return History.pushState(change_url, document.title.replace(/^(.*)\|.*$/, "$1 | ") + change_url, "/" + change_url);
    });
    History = window.History;
    return History.Adapter.bind(window, "statechange", function() {
      var State, next_page;
      State = History.getState();
      next_page = State.url.replace(/(.*\.com|.*:3000)/, "").replace(/\//g, "");
      if (next_page === "") {
        next_page = "index";
      }
      return changePage(next_page);
    });
  });

  changePage = function(new_url) {
    if ($("body").attr("class") === new_url) {
      return;
    }
    $("#content-wrapper").stop(false, true).slideUp(animation_speed, function() {
      if (new_url === "") {
        new_url = "index";
      }
      return $.get("/pages/" + new_url, function(data) {
        console.log(data);
        $("body").attr("class", new_url);
        return $("#content-wrapper").html(data.content).delay(animation_delay).slideDown(animation_speed, function() {
          return console.log("Animation Complete");
        });
      });
    });
    if (typeof _gaq !== "undefined") {
      return _gaq.push(["_trackPageview", new_url + "/"]);
    }
  };

}).call(this);
